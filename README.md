# CS18000-Group-Project

# Instructions on how to compile and run project
For Phase 1, we do not have a dedicated main method to show the interaction between the clients to the server to the databases. For Phase 2, we have a Server.java class that you can run once on your computer to start the server and interaction between clients. After running the Server class, you can run the Client.java class to run our fully (mostly) functioning social media app in the console. If you want to simulate the social media app working on multiple devices, use IntelliJ’s Code with Me platform to share your workspace and allow every joined developer to run the Client in the terminal. 

Here is some context to help you navigate the application:
- There is some input validation for the first couple menus but afterwards it is assumed that the user will type the correct input because console input is only temporary and will be converted to buttons and dedicated text fields in Phase 3
- The application starts with a menu where you can either sign in or create a new account. When you first run the program, there is no data in the database, so make your own account and password. Hit 1 or 2.
- Once you sign in, you will have the option to either edit your profile, search for a user, or exit the program. Hit 1, 2, or 3. 
- If you’re editing your profile, you will be able to see your current profile name (defaulted to your login username), description, friends list, and blocked list. You will have the choice (1 or 2) to edit your profile name or your description
- If you’re searching for another user, please search for their login username, as that is the name that would be constant throughout a user’s lifetime (profile name can change). 
Once you search for a user, you will have a new menu with options; you will also be able to see their profile name, description, and friends list. You can either choose to add/remove them as a friend, add/remove them from your blocked list, directly message them, or go back. Pick a number within the range (1 through 4)
- If you choose to add or remove them as a friend, pick 1 or 2 based on the prompt
- If you choose to add or remove them from your blocked list, pick 1 or 2 based on the prompt
- If you choose to directly message them, the system will first load your message history with them before allowing you to type (note that to message them you and the receiver cannot be blocking each other). Type to your heart’s content. The receiver will know which messages are from you since it will be sent with your login username attached. While the sender cannot see their name attached to their own message currently, that will be implemented in Phase 3. The spacing of the chat might be a little wonky if two people are typing and sending to each other (i.e. one person sends a message while the other is typing something). The chat still works perfectly fine though. There’s not much that can be done to fix it within the console, so proper messaging with consistent spacing will be added in Phase 3. 
- To exit the chat, type “/bye”
- To delete a message, type “/” followed by the index of the message in the list that you want to delete (starts from 0 and you can only delete your own messages). 
- Note that the way we currently leave the chat and delete messages is only temporary and better solutions will be implemented in the GUI in Phase 3 

There are no test cases written for our new classes that were created to build the client and server as all of those are IO functionality related. We have updated the previous test scripts though: UserTest.java, ProfileTest.java, DatabaseTest.java, ChatTest.java, and ChatDatabaseTest.java. Open the project on IntelliJ, install JUnit5 packages if prompted to, and press the run button at the top right corner (or F5) to run each test script. 

# Brightspace and Vocareum Submission
Jason Chan submitted Phase 1 workspace to Vocareum<br>
Jason Chan submitted Phase 2 workspace to Vocareum

# Class Descriptions
## Chat 
The chat class is used to simulate a chat between multiple users. It implements serializable which lets you save the state of chats between sessions. The class has two fields, id and messages. The id is used to get a unique chat between two users by concatenating the two usernames alphabetically in the constructor. Messages is an array list that contains the messages sent within the chat. The equals method is comparing the chat id to another object's chat id to see if they are representing the same chat. The id can be reproduced on either end of the client when they create a new Chat instance and pass in their username and then their receiver’s username. By being able to reproduce the id on both ends, we are able to get the same messages data for each client. The getID() method returns the id of the chat as a string. The getMessages() method returns the messages array list. The addMessage(String message) method allows users to add a message to the array list or chat. The removeMessage(int index) method allows users to remove/delete a message from the array list. The chat class is independent from other classes but it does interact with the ChatDatabase class. Instances of the class will later be created on the server. Our tests verify that the add and remove function correctly adds or removes a chat from the arraylist. We also verify that our constructor is correctly constructing the id to our intentions and that our equals method correctly identifies that. We simulated how the equals method would be used on the server by creating two Chat instances with the same usernames (but ordered differently) and making sure that they have the same id. 

## ChatDatabase
The ChatDatabase class is a database containing chat objects. It’s used for loading and saving classes. The chat objects are stored with a chats.dat file. This class has one field, chats. Chats is a arrayList of type Chat	 that holds all the chat objects. The constructor loads the chats from the chats.dat file and if a chat does not exist or an error occurs it will throw an exception to prevent the program from crashing. The method saveChat(Chat chat) updates a chat by rewriting the chats.dat file, re-adding all the chats in the file that doesn’t have the same id as variable chat but replacing the old chat with the same id with the updated chat. The addChat(Chat chat) method adds a new chat to the chats array list and appends it to the database. When the chat is successfully added to the database, a message saying “Chat has been registered” is printed as a confirmation. The chatRegistered(Chat chat) checks if a chat already exists within the chat list by comparing the existing chat ids with the id passed through the parameter. It returns true if the id exists and false if not. ChatDatabase interacts with Chat to save and get chat instances. It will later be requested by the server, first calling the chatRegistered, then addChat (if chat doesn’t exist), then saveChat method (whenever a client adds or deletes a message). The test for this class verifies that the database is properly writing to the chats.dat file and that we can retrieve and interpret that data. We do this by first creating a Chat instance with two usernames and populating it with random messages. We then save that chat to the database. To test if we can read the data, we create a new ChatDatabase object and a new Chat instance with the same usernames in a different order, to simulate how we would be writing this out on the server. We ensure that the chat already exists in the database and then make sure that that saved chat has the same messages that were initially stored. 

## Profile
The profile class is used to create a profile for a user that contains their name, a description of them, their friend list, and their blocked list. The class has 4 fields: name, description, friends, and blockedUsers. The constructor initializes the String name, String description, the String array list friends, and the String array list blockedUsers. There are 4 getters which return name, description, friends, and blockedUsers, respectively.  There are two setters that allow setting a new name for the profile and a new description, setName(String name) and setDescription(String description) respectively. The addFriend(String username) adds a username to the friends list. The removeFriend(String username) method removes a username from the friends list. The addBlock(String username) adds the passed in username to the block list. The removeBlock(String username) removes the passed in username from the blocked list. There are 2 versions of the isFriend function, isFriend(Profile) and isFriend(User user), the difference is that one checks if the profiles friends contains the profile name from the profile passed while the one with the user as a variable passed checks for if the profiles friends contains the loginUsername. The same is the case for the isBlocked functions where there is isBlocked(Profile profile) which checks if the profile username is blocked, and the isBlocked(User user which checks for if the loginUsername is blocked). The profile class is a subclass of the User class and adds information on top of what is provided from the User class. Tests for this class consisted of ensuring that each fundamental method was correctly working as intended (i.e. friends were friends, blocked people were blocked, etc.). This class doesn’t have the methods to actually have one User friend another (that is in the Database class), but we can still populate Users with dummy friends to test.

## User
The user class is used to store basic information about a user and implements serializable to allow storage and retrieval of that data. The class has 3 fields: loginUsername, password, and profile. The constructor initializes a new instance of user with the passed in username, password, and profile. The class has 3 getters which return loginUsername, password, and profile respectively. The equalsUsername(User user) method compares two usernames to each other and returns true if they are equal and false if not. The equalsPassword(User user) method compares two passwords to each other and returns true if they are equal and false if not. The user class is the parent class of the profile class and has a reference to profile within it. The user class is related to the database class as the database class is where user objects are stored. Tests for this class consisted of creating dummy Users with different usernames and passwords and ensuring our equals methods were outputting the correct results based on the inputs. 

## Database
The database class gives a way to store User objects which allows for loading, adding, and managing users. The class has one field, users, which is an array list of type User that stores all the user objects. The constructor initializes users and loads users from the users.dat file  using an ObjectInputStream. It reads this file until an EOF exception is caught at which point the program continues. The addUser(User user) method adds a user to the users array list and appends the new user to users.dat. The getUsers() method returns the users array list. The getUser(String username) retrieves the specified user from the users array list by searching using username, returns null if username isn’t found. The nameAlreadyExists(User user) method checks if a username already exists within the database by using equalsUsername method. The passwordAlreadyExists(User user) checks if a password already exists within the database by using the equalsPassword method. The friendUser(String username1, String username2) checks if the users are already friends with each other or if they have blocked each other. If neither of these conditions are true then the users become friends. The blockUser(String username1, String username2) checks if the users are already blocked and if they are friends with each other. If they are friends with each other it removes them as friends and adds them to the block list. This method returns if the user was just blocked or if they were blocked and unfriended. There is also the getUserFromProfile(Profile profile) which returns the user with the corresponding profile name. There is also a function called saveUsers() which rewrites all of the current users in the database to the output file. The database class is related to the user since it stores all of the user data within the users.dat file. Testing for this class ensured that the Database can retrieve information about saved Users properly. We did this by adding a User into the database, then creating a new Database to retrieve the stored information and check to make sure that stored User has the same username. Testing also included populating friends and blocks through the database, ensuring logins and passwords exist/match, and ensuring that blocking a friend unfriends the users. 

## Server
The server class manages multiple clients, handles multi threading, and provides access to Database and ChatDatabase. It checks for connections of port 8080 and creates a new socket for each client. Each client gets its own clientHandler object that is stored within an arraylist. The server class has a couple static variables: clients (a list of Sockets), clientHandlers (a list of ClientHandler threads), db (a Database class instance), chatDb (a ChatDatabase class instance), serverSocket (a Server Socket reference). It has getters for some of the fields: getDatabase(), getChatDatabase(), and getClientHandlers(). We also have a public static void removeClient(ClientHandler sender, Socket client) that removes a client and its respective clientHandler when they exit the program properly or abruptly. The server class is related to the Database and ChatDatabase classes because it allows access to those databases. 

## Client
Client class uses a socket to connect to a server. It lets the user sign in and communicate through the server. The run method is where the client connects to the server, the username and password are obtained, and allows for communication with the server. It begins by getting a socket connection to the server, then it initializes an input and output stream. The user is then prompted to login or create an account. The Client class also has the interactions for adding or removing friends, blocking or unblocking people, and messaging others. The client class is related to the server class and uses it to handle incoming messages from another client. The client class is also related to the User class since it uses the user’s credentials(username and password). The class is also connected to the ClientHandler class since an instance of ClientHandler is created to allow for multiple clients at once. It also is related to MessageOutputHandler for message handling. The client is what is executed to run the main application. Details of the main application and how to interact with it is in the compilation instructions.

## ClientHandler
The ClientHandler is responsible for managing each instance of Client. It uses the runnable interface to allow for handling each client in a separate thread. This class prompts for account sign in, account creation, searching for other users, messaging others, editing your own profile, blocking users, adding users as friends , removing friends, and unblocking users. It is related to the Database class since it accesses it to get the user information for the editing and the search. It also is related to the ChatDatabase class because it uses that to store the messaging history.

## MessageOutputHandler
MessageOutputHandler is used to handle incoming messages. It uses runnable to run everything in a separate thread. It uses a bufferedReader to read the incoming messages. When run, it goes into an infinite loop that will read messages using the bufferedreader. The loop will stop when the command /bye is input, all other inputs will be printed to the console. 

# IO Testing
Extensive testing was commenced to ensure that the social media console application is fully functioning, bug free, and working as it is currently intended. In the sign in menu, we made sure to test to make sure the server denies creation of already existing usernames and deny incorrect username or password during sign-ins. We made sure to run around the program, visiting different menus in different orders to make sure that the menu flow is working as intended and nothing breaks. We made sure that, when editing the profile name or description, other users can immediately see the changes if they research the same username. We ensured that the adding/removing of friends and blocked users works as intended and the information is shared immediately with other clients. While doing all of this, we also made sure to rerun the server so that we know that the database is correctly retrieving all the information stored through the .dat files. We also make sure to handle all errors that could occur when the client abruptly leaves and closes the program. We don’t want the server to throw an error and cause problems for others because of that (even though it probably won’t because everything is on separate threads). We made sure to also extensively test the messaging system. Two clients can send messages to each other with ease. Some current caveats have already been listed in the compilation section. If one client leaves, the other client can still keep sending messages and when the other user comes back the message history will be updated so he will see all of the new messages that he didn’t read while he was gone. Deleting and exiting in the console specific way also works perfectly.
